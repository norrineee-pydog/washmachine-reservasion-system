<!--pages/index/index.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
  <view class="status-bar">
    <view class="weather-info">
      <text class="weather-temp">{{weather.temp}}Â°</text>
      <text class="weather-desc">{{weather.desc}}</text>
    </view>
    <view class="user-info" bindtap="goToProfile">
      <text class="user-name">{{userInfo ? userInfo.nickName : 'è¯·ç™»å½•'}}</text>
      <text class="user-building">{{currentBuilding ? currentBuilding.name : 'é€‰æ‹©æ¥¼æ ‹'}}</text>
    </view>
  </view>

  <!-- åˆ é™¤æœç´¢æ ï¼Œç›´æ¥æ˜¾ç¤ºæ´—è¡£æœºçŠ¶æ€æ¦‚è§ˆ -->
  
  <!-- æ´—è¡£æœºçŠ¶æ€æ¦‚è§ˆ -->
  <view class="status-overview">
    <view class="overview-card">
      <view class="overview-item">
        <text class="overview-count {{statusSummary.idle > 0 ? 'idle' : ''}}">{{statusSummary.idle}}</text>
        <text class="overview-label">ç©ºé—²</text>
      </view>
      <view class="overview-item">
        <text class="overview-count {{statusSummary.booking > 0 ? 'booking' : ''}}">{{statusSummary.booking}}</text>
        <text class="overview-label">é¢„çº¦ä¸­</text>
      </view>
      <view class="overview-item">
        <text class="overview-count {{statusSummary.working > 0 ? 'working' : ''}}">{{statusSummary.working}}</text>
        <text class="overview-label">å·¥ä½œä¸­</text>
      </view>
      <view class="overview-item">
        <text class="overview-count {{statusSummary.ready > 0 ? 'ready' : ''}}">{{statusSummary.ready}}</text>
        <text class="overview-label">å¾…å–è¡£</text>
      </view>
    </view>
  </view>

  <!-- æ´—è¡£æœºåˆ—è¡¨ -->
  <view class="washer-section">
    <view class="section-header">
      <text class="section-title">æ´—è¡£æœºåˆ—è¡¨</text>
      <view class="section-actions">
        <text class="refresh-btn" bindtap="refreshStatus">åˆ·æ–°</text>
      </view>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{loading}}">
      <text>åŠ è½½ä¸­...</text>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:elif="{{!hasData && !loading}}">
      <text class="empty-text">æš‚æ— æ´—è¡£æœºæ•°æ®</text>
    </view>

    <!-- æ´—è¡£æœºåˆ—è¡¨ -->
    <scroll-view class="washer-list" scroll-y wx:else>
      <block wx:for="{{washerList}}" wx:key="id">
        <view class="washer-item {{item.status}}" bindtap="selectWasher" data-washer="{{item}}">
          <view class="washer-info">
            <view class="washer-header">
              <text class="washer-name">{{item.name}}</text>
              <view class="washer-status {{item.status}}">
                <text>{{item.statusText}}</text>
              </view>
            </view>
            <view class="washer-details">
              <text class="washer-location">{{item.location}}</text>
              <text class="washer-type">{{item.type}} Â· {{item.capacity}}</text>
            </view>
            <view class="washer-footer">
              <text class="washer-price">ï¿¥{{item.pricePerHour}}/å°æ—¶</text>
              <text class="washer-remaining" wx:if="{{item.remainingTime}}">{{item.remainingTime}}</text>
            </view>
          </view>
          <view class="washer-action">
            <text class="action-arrow">â€º</text>
          </view>
        </view>
      </block>
    </scroll-view>
  </view>

  <!-- æ™ºèƒ½æ¨è -->
  <view class="recommendation-section" wx:if="{{recommendations.length > 0}}">
    <view class="section-header">
      <text class="section-title">æ™ºèƒ½æ¨è</text>
    </view>
    <view class="recommendation-list">
      <block wx:for="{{recommendations}}" wx:key="id">
        <view class="recommendation-item">
          <view class="recommendation-time">
            <text class="time-slot">{{item.time}}</text>
            <text class="time-date">{{item.date}}</text>
          </view>
          <view class="recommendation-content">
            <text class="recommendation-desc">{{item.description}}</text>
            <view class="recommendation-score">
              <text class="score-text">æ¨èåº¦</text>
              <text class="score-value">{{item.score}}%</text>
            </view>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- å…¬å‘Šé€šçŸ¥ -->
  <view class="notice-section" wx:if="{{notices.length > 0}}">
    <view class="section-header">
      <text class="section-title">å…¬å‘Šé€šçŸ¥</text>
    </view>
    <view class="notice-list">
      <block wx:for="{{notices}}" wx:key="id">
        <view class="notice-item" bindtap="viewNotice" data-notice="{{item}}">
          <view class="notice-icon">ğŸ“¢</view>
          <view class="notice-content">
            <text class="notice-title">{{item.title}}</text>
            <text class="notice-time">{{item.time}}</text>
          </view>
          <view class="notice-arrow">â€º</view>
        </view>
      </block>
    </view>
  </view>

  <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
  <view class="safe-area"></view>
</view>