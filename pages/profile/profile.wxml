<!--pages/profile/profile.wxml-->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card">
    <view class="user-info">
      <view class="user-avatar">
        <image src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" class="avatar-img"></image>
        <view class="avatar-badge" wx:if="{{userInfo.level}}">{{userInfo.level}}</view>
      </view>
      <view class="user-details">
        <view class="user-name">{{userInfo.nickName || 'æœªç™»å½•'}}</view>
        <view class="user-id">å­¦å·ï¼š{{userInfo.studentId || 'æœªè®¾ç½®'}}</view>
        <view class="user-location">{{userInfo.buildingName}} {{userInfo.roomNumber}}</view>
      </view>
    </view>
    
    <view class="credit-info">
      <view class="credit-score">
        <text class="score-number">{{userInfo.creditScore || 100}}</text>
        <text class="score-label">ä¿¡ç”¨ç§¯åˆ†</text>
      </view>
      <view class="credit-level">
        <text class="level-text">{{userInfo.level || 'é’é“œ'}}</text>
        <view class="level-progress">
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{creditProgress}}%"></view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-section">
    <view class="menu-group">
      <view class="menu-item" bindtap="goToPage" data-url="/pages/booking/booking">
        <view class="menu-icon booking">ğŸ“…</view>
        <text class="menu-text">æˆ‘çš„é¢„çº¦</text>
        <view class="menu-badge" wx:if="{{bookingCount > 0}}">{{bookingCount}}</view>
        <text class="menu-arrow">></text>
      </view>
      
      <view class="menu-item" bindtap="goToPage" data-url="/pages/message/message">
        <view class="menu-icon message">ğŸ’¬</view>
        <text class="menu-text">æ¶ˆæ¯ä¸­å¿ƒ</text>
        <view class="menu-badge" wx:if="{{messageCount > 0}}">{{messageCount}}</view>
        <text class="menu-arrow">></text>
      </view>
      
      <view class="menu-item" bindtap="goToPage" data-url="/pages/credit/credit">
        <view class="menu-icon credit">ğŸ†</view>
        <text class="menu-text">ä¿¡ç”¨ä¸­å¿ƒ</text>
        <text class="menu-arrow">></text>
      </view>
    </view>

    <view class="menu-group">
      <view class="menu-item" bindtap="goToPage" data-url="/pages/help/help">
        <view class="menu-icon help">â“</view>
        <text class="menu-text">å¸®åŠ©ä¸­å¿ƒ</text>
        <text class="menu-arrow">></text>
      </view>
      
      <view class="menu-item" bindtap="goToPage" data-url="/pages/settings/settings">
        <view class="menu-icon settings">âš™ï¸</view>
        <text class="menu-text">è®¾ç½®</text>
        <text class="menu-arrow">></text>
      </view>
      
      <view class="menu-item" bindtap="goToPage" data-url="/pages/about/about">
        <view class="menu-icon about">â„¹ï¸</view>
        <text class="menu-text">å…³äºæˆ‘ä»¬</text>
        <text class="menu-arrow">></text>
      </view>
    </view>
  </view>

  <!-- ä½¿ç”¨ç»Ÿè®¡ -->
  <view class="statistics-section">
    <view class="section-header">
      <text class="section-title">ä½¿ç”¨ç»Ÿè®¡</text>
    </view>
    
    <view class="statistics-grid">
      <view class="stat-item">
        <text class="stat-number">{{statistics.totalBookings}}</text>
        <text class="stat-label">æ€»é¢„çº¦æ¬¡æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{statistics.successRate}}%</text>
        <text class="stat-label">æˆåŠŸç‡</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{statistics.avgWaitTime}}</text>
        <text class="stat-label">å¹³å‡ç­‰å¾…</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{statistics.totalTime}}</text>
        <text class="stat-label">æ€»ä½¿ç”¨æ—¶é•¿</text>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘æ´»åŠ¨ -->
  <view class="activity-section">
    <view class="section-header">
      <text class="section-title">æœ€è¿‘æ´»åŠ¨</text>
      <text class="view-all" bindtap="viewAllActivity">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>
    
    <view class="activity-list">
      <view class="activity-item" wx:for="{{recentActivities}}" wx:key="id">
        <view class="activity-icon {{item.type}}">{{item.icon}}</view>
        <view class="activity-content">
          <text class="activity-title">{{item.title}}</text>
          <text class="activity-time">{{item.time}}</text>
        </view>
        <view class="activity-status">
          <text class="status-text">{{item.status}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- é€€å‡ºç™»å½• -->
  <view class="logout-section" wx:if="{{userInfo}}">
    <button class="logout-btn" bindtap="logout">é€€å‡ºç™»å½•</button>
  </view>

  <!-- ç™»å½•æŒ‰é’® -->
  <view class="login-section" wx:if="{{!userInfo}}">
    <button class="login-btn" bindtap="goToLogin">ç«‹å³ç™»å½•</button>
  </view>
</view>
